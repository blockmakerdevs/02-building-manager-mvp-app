{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"onMomentumScrollEnd\", \"style\"];\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useCallback, useContext, useMemo, useEffect } from 'react';\nimport TabBarContext from \"./TabBarContext\";\nimport Reanimated, { runOnJS, useAnimatedReaction, useAnimatedRef, useAnimatedScrollHandler, useSharedValue } from 'react-native-reanimated';\nimport { Constants } from \"../../commons/new\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar FIX_RTL = Constants.isRTL && Constants.isAndroid;\nfunction PageCarousel(props) {\n  var onMomentumScrollEnd = props.onMomentumScrollEnd,\n    style = props.style,\n    others = _objectWithoutProperties(props, _excluded);\n  var carousel = useAnimatedRef();\n  var _useContext = useContext(TabBarContext),\n    itemsCount = _useContext.itemsCount,\n    currentPage = _useContext.currentPage,\n    targetPage = _useContext.targetPage,\n    pageWidth = _useContext.pageWidth,\n    setCurrentIndex = _useContext.setCurrentIndex;\n  var initialOffset = useMemo(function () {\n    return {\n      x: currentPage.value * pageWidth,\n      y: 0\n    };\n  }, []);\n  var indexChangeReason = useSharedValue(undefined);\n  var scrollToInitial = useCallback(function () {\n    if (Constants.isAndroid && currentPage.value) {\n      scrollToItem(currentPage.value);\n    }\n  }, []);\n  var calcOffset = useCallback(function (offset) {\n    'worklet';\n\n    return FIX_RTL ? pageWidth * (itemsCount - 1) - offset : offset;\n  }, [pageWidth, itemsCount]);\n  var scrollHandler = useAnimatedScrollHandler({\n    onScroll: function onScroll(e) {\n      var xOffset = calcOffset(e.contentOffset.x);\n      var newIndex = xOffset / pageWidth;\n      if (indexChangeReason.value === 'byPress') {\n        indexChangeReason.value = undefined;\n      } else {\n        targetPage.value = newIndex;\n      }\n    },\n    onMomentumEnd: function onMomentumEnd(e) {\n      var xOffset = calcOffset(e.contentOffset.x);\n      var newPage = Math.round(xOffset / pageWidth);\n      indexChangeReason.value = 'byScroll';\n      setCurrentIndex(newPage);\n    }\n  });\n  var scrollToItem = useCallback(function (index) {\n    var _carousel$current;\n    if (indexChangeReason.value === 'byScroll') {\n      indexChangeReason.value = undefined;\n    } else {\n      indexChangeReason.value = 'byPress';\n    }\n    var actualIndex = FIX_RTL ? itemsCount - index - 1 : index;\n    (_carousel$current = carousel.current) == null ? void 0 : _carousel$current.scrollTo({\n      x: actualIndex * pageWidth,\n      animated: false\n    });\n  }, [pageWidth, itemsCount]);\n  useAnimatedReaction(function () {\n    return currentPage.value;\n  }, function (currIndex, prevIndex) {\n    if (prevIndex !== null && currIndex !== prevIndex) {\n      runOnJS(scrollToItem)(currIndex);\n    }\n  });\n  useEffect(function () {\n    var _carousel$current2;\n    (_carousel$current2 = carousel.current) == null ? void 0 : _carousel$current2.scrollTo({\n      x: currentPage.value * pageWidth,\n      animated: false\n    });\n  }, [pageWidth]);\n  var handleOnMomentumScrollEnd = useCallback(function (event) {\n    onMomentumScrollEnd == null ? void 0 : onMomentumScrollEnd(event);\n  }, [onMomentumScrollEnd]);\n  var _style = useMemo(function () {\n    return [{\n      width: pageWidth\n    }, style];\n  }, [pageWidth, style]);\n  return _jsx(Reanimated.ScrollView, _objectSpread(_objectSpread({}, others), {}, {\n    style: _style,\n    ref: carousel,\n    horizontal: true,\n    pagingEnabled: true,\n    showsHorizontalScrollIndicator: false,\n    onScroll: scrollHandler,\n    scrollEventThrottle: 16,\n    contentOffset: initialOffset,\n    onLayout: scrollToInitial,\n    onMomentumScrollEnd: handleOnMomentumScrollEnd\n  }));\n}\nexport default PageCarousel;","map":{"version":3,"names":["React","useCallback","useContext","useMemo","useEffect","TabBarContext","Reanimated","runOnJS","useAnimatedReaction","useAnimatedRef","useAnimatedScrollHandler","useSharedValue","Constants","jsx","_jsx","FIX_RTL","isRTL","isAndroid","PageCarousel","props","onMomentumScrollEnd","style","others","_objectWithoutProperties","_excluded","carousel","_useContext","itemsCount","currentPage","targetPage","pageWidth","setCurrentIndex","initialOffset","x","value","y","indexChangeReason","undefined","scrollToInitial","scrollToItem","calcOffset","offset","scrollHandler","onScroll","e","xOffset","contentOffset","newIndex","onMomentumEnd","newPage","Math","round","index","_carousel$current","actualIndex","current","scrollTo","animated","currIndex","prevIndex","_carousel$current2","handleOnMomentumScrollEnd","event","_style","width","ScrollView","_objectSpread","ref","horizontal","pagingEnabled","showsHorizontalScrollIndicator","scrollEventThrottle","onLayout"],"sources":["/Users/mac/Repositories/BlockmakerIT/02-building-manager-mvp-app/node_modules/react-native-ui-lib/src/components/tabController/PageCarousel.js"],"sourcesContent":["import React, { useCallback, useContext, useMemo, useEffect } from 'react';\nimport TabBarContext from \"./TabBarContext\";\nimport Reanimated, { runOnJS, useAnimatedReaction, useAnimatedRef, useAnimatedScrollHandler, useSharedValue } from 'react-native-reanimated';\nimport { Constants } from \"../../commons/new\";\nconst FIX_RTL = Constants.isRTL && Constants.isAndroid;\n\n/**\n * @description: TabController's Page Carousel\n * @example: https://github.com/wix/react-native-ui-lib/blob/master/demo/src/screens/componentScreens/TabControllerScreen/index.tsx\n * @notes: You must pass `asCarousel` flag to TabController and render your TabPages inside a PageCarousel\n */\nfunction PageCarousel(props) {\n  const {\n    onMomentumScrollEnd,\n    style,\n    ...others\n  } = props;\n  const carousel = useAnimatedRef();\n  const {\n    itemsCount,\n    currentPage,\n    targetPage,\n    pageWidth,\n    // carouselOffset,\n    setCurrentIndex\n  } = useContext(TabBarContext);\n  const initialOffset = useMemo(() => ({\n    x: currentPage.value * pageWidth,\n    y: 0\n  }), []);\n  const indexChangeReason = useSharedValue(undefined);\n  const scrollToInitial = useCallback(() => {\n    if (Constants.isAndroid && currentPage.value) {\n      scrollToItem(currentPage.value);\n    }\n  }, []);\n  const calcOffset = useCallback(offset => {\n    'worklet';\n\n    return FIX_RTL ? pageWidth * (itemsCount - 1) - offset : offset;\n  }, [pageWidth, itemsCount]);\n  const scrollHandler = useAnimatedScrollHandler({\n    onScroll: e => {\n      // carouselOffset.value = e.contentOffset.x;\n      const xOffset = calcOffset(e.contentOffset.x);\n      const newIndex = xOffset / pageWidth;\n      if (indexChangeReason.value === 'byPress') {\n        // Scroll was immediate and not by gesture\n        /* Round is for android when offset value has fraction */\n        // targetPage.value = withTiming(Math.round(newIndex));\n\n        indexChangeReason.value = undefined;\n      } else {\n        targetPage.value = newIndex;\n      }\n    },\n    onMomentumEnd: e => {\n      const xOffset = calcOffset(e.contentOffset.x);\n      const newPage = Math.round(xOffset / pageWidth);\n      indexChangeReason.value = 'byScroll';\n      setCurrentIndex(newPage);\n    }\n  });\n  const scrollToItem = useCallback(index => {\n    if (indexChangeReason.value === 'byScroll') {\n      indexChangeReason.value = undefined;\n    } else {\n      indexChangeReason.value = 'byPress';\n    }\n    const actualIndex = FIX_RTL ? itemsCount - index - 1 : index;\n    carousel.current?.scrollTo({\n      x: actualIndex * pageWidth,\n      animated: false\n    });\n  }, [pageWidth, itemsCount]);\n  useAnimatedReaction(() => {\n    return currentPage.value;\n  }, (currIndex, prevIndex) => {\n    if (prevIndex !== null && currIndex !== prevIndex) {\n      runOnJS(scrollToItem)(currIndex);\n    }\n  });\n  useEffect(() => {\n    carousel.current?.scrollTo({\n      x: currentPage.value * pageWidth,\n      animated: false\n    });\n  }, [pageWidth]);\n  const handleOnMomentumScrollEnd = useCallback(event => {\n    onMomentumScrollEnd?.(event);\n  }, [onMomentumScrollEnd]);\n  const _style = useMemo(() => {\n    return [{\n      width: pageWidth\n    }, style];\n  }, [pageWidth, style]);\n  return <Reanimated.ScrollView {...others} style={_style}\n  // @ts-expect-error should be fixed in version 3.5 (https://github.com/software-mansion/react-native-reanimated/pull/4881)\n  ref={carousel} horizontal pagingEnabled showsHorizontalScrollIndicator={false} onScroll={scrollHandler} scrollEventThrottle={16} contentOffset={initialOffset} // iOS only\n  onLayout={scrollToInitial} // Android only\n  onMomentumScrollEnd={handleOnMomentumScrollEnd} // TODO: workaround for useAnimatedScrollHandler.onMomentumEnd not being called (https://github.com/software-mansion/react-native-reanimated/issues/2735)\n  />;\n}\nexport default PageCarousel;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}