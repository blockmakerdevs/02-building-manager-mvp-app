{"ast":null,"code":"import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nvar _excluded = [\"data\", \"onOrderChange\", \"enableHaptic\", \"scale\", \"itemProps\", \"horizontal\"];\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport _reduce from \"lodash/reduce\";\nimport _filter from \"lodash/filter\";\nimport _mapKeys from \"lodash/mapKeys\";\nimport _map from \"lodash/map\";\nimport React, { useMemo, useCallback } from 'react';\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport { useSharedValue } from 'react-native-reanimated';\nimport { GestureHandlerRootView } from 'react-native-gesture-handler';\nimport SortableListContext from \"./SortableListContext\";\nimport SortableListItem, { DEFAULT_LIST_ITEM_SIZE } from \"./SortableListItem\";\nimport { useDidUpdate, useThemeProps } from \"../../hooks\";\nimport { SortableListProps, SortableListItemProps } from \"./types\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport { SortableListProps, SortableListItemProps };\nfunction generateItemsOrder(data) {\n  return _map(data, function (item) {\n    return item.id;\n  });\n}\nfunction generateLockedIds(data) {\n  return _reduce(_filter(data, function (item) {\n    return item.locked;\n  }), function (item, cur) {\n    return _objectSpread(_objectSpread({}, item), {}, _defineProperty({}, cur.id, true));\n  }, {});\n}\nvar SortableList = function SortableList(props) {\n  var themeProps = useThemeProps(props, 'SortableList');\n  var data = themeProps.data,\n    onOrderChange = themeProps.onOrderChange,\n    enableHaptic = themeProps.enableHaptic,\n    scale = themeProps.scale,\n    itemProps = themeProps.itemProps,\n    horizontal = themeProps.horizontal,\n    others = _objectWithoutProperties(themeProps, _excluded);\n  var itemsOrder = useSharedValue(generateItemsOrder(data));\n  var lockedIds = useSharedValue(generateLockedIds(data));\n  var itemSize = useSharedValue(DEFAULT_LIST_ITEM_SIZE);\n  useDidUpdate(function () {\n    itemsOrder.value = generateItemsOrder(data);\n  }, [data]);\n  var onChange = useCallback(function () {\n    var newData = [];\n    var dataByIds = _mapKeys(data, 'id');\n    if (data != null && data.length) {\n      itemsOrder.value.forEach(function (itemId) {\n        newData.push(dataByIds[itemId]);\n      });\n    }\n    onOrderChange == null ? void 0 : onOrderChange(newData);\n  }, [onOrderChange, data]);\n  var onItemLayout = useCallback(function (event) {\n    var _event$nativeEvent$la = event.nativeEvent.layout,\n      height = _event$nativeEvent$la.height,\n      width = _event$nativeEvent$la.width;\n    var newSize = Math.round(horizontal ? width : height);\n    if (newSize) {\n      var _itemProps$margins$ma, _itemProps$margins, _itemProps$margins$ma2, _itemProps$margins2, _itemProps$margins$ma3, _itemProps$margins3, _itemProps$margins$ma4, _itemProps$margins4;\n      var margins = horizontal ? ((_itemProps$margins$ma = itemProps == null ? void 0 : (_itemProps$margins = itemProps.margins) == null ? void 0 : _itemProps$margins.marginLeft) != null ? _itemProps$margins$ma : 0) + ((_itemProps$margins$ma2 = itemProps == null ? void 0 : (_itemProps$margins2 = itemProps.margins) == null ? void 0 : _itemProps$margins2.marginRight) != null ? _itemProps$margins$ma2 : 0) : ((_itemProps$margins$ma3 = itemProps == null ? void 0 : (_itemProps$margins3 = itemProps.margins) == null ? void 0 : _itemProps$margins3.marginTop) != null ? _itemProps$margins$ma3 : 0) + ((_itemProps$margins$ma4 = itemProps == null ? void 0 : (_itemProps$margins4 = itemProps.margins) == null ? void 0 : _itemProps$margins4.marginBottom) != null ? _itemProps$margins$ma4 : 0);\n      itemSize.value = newSize + margins;\n    }\n  }, []);\n  var context = useMemo(function () {\n    return {\n      data: data,\n      itemsOrder: itemsOrder,\n      lockedIds: lockedIds,\n      onChange: onChange,\n      itemSize: itemSize,\n      horizontal: horizontal,\n      itemProps: itemProps,\n      onItemLayout: onItemLayout,\n      enableHaptic: enableHaptic,\n      scale: scale\n    };\n  }, [data]);\n  return _jsx(GestureHandlerRootView, {\n    children: _jsx(SortableListContext.Provider, {\n      value: context,\n      children: _jsx(FlatList, _objectSpread(_objectSpread({}, others), {}, {\n        horizontal: horizontal,\n        data: data,\n        CellRendererComponent: SortableListItem,\n        removeClippedSubviews: false\n      }))\n    })\n  });\n};\nexport default SortableList;","map":{"version":3,"names":["_reduce","_filter","_mapKeys","_map","React","useMemo","useCallback","FlatList","useSharedValue","GestureHandlerRootView","SortableListContext","SortableListItem","DEFAULT_LIST_ITEM_SIZE","useDidUpdate","useThemeProps","SortableListProps","SortableListItemProps","jsx","_jsx","generateItemsOrder","data","item","id","generateLockedIds","locked","cur","_objectSpread","_defineProperty","SortableList","props","themeProps","onOrderChange","enableHaptic","scale","itemProps","horizontal","others","_objectWithoutProperties","_excluded","itemsOrder","lockedIds","itemSize","value","onChange","newData","dataByIds","length","forEach","itemId","push","onItemLayout","event","_event$nativeEvent$la","nativeEvent","layout","height","width","newSize","Math","round","_itemProps$margins$ma","_itemProps$margins","_itemProps$margins$ma2","_itemProps$margins2","_itemProps$margins$ma3","_itemProps$margins3","_itemProps$margins$ma4","_itemProps$margins4","margins","marginLeft","marginRight","marginTop","marginBottom","context","children","Provider","CellRendererComponent","removeClippedSubviews"],"sources":["/Users/mac/Repositories/BlockmakerIT/02-building-manager-mvp-app/node_modules/react-native-ui-lib/src/components/sortableList/index.js"],"sourcesContent":["import _reduce from \"lodash/reduce\";\nimport _filter from \"lodash/filter\";\nimport _mapKeys from \"lodash/mapKeys\";\nimport _map from \"lodash/map\";\n/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useMemo, useCallback } from 'react';\nimport { FlatList } from 'react-native';\nimport { useSharedValue } from 'react-native-reanimated';\nimport { GestureHandlerRootView } from 'react-native-gesture-handler';\nimport SortableListContext from \"./SortableListContext\";\nimport SortableListItem, { DEFAULT_LIST_ITEM_SIZE } from \"./SortableListItem\";\nimport { useDidUpdate, useThemeProps } from \"../../hooks\";\nimport { SortableListProps, SortableListItemProps } from \"./types\";\nexport { SortableListProps, SortableListItemProps };\nfunction generateItemsOrder(data) {\n  return _map(data, item => item.id);\n}\nfunction generateLockedIds(data) {\n  // @ts-expect-error - not worth further time investment IMO, maybe it'll work some day\n  return _reduce(_filter(data, item => item.locked),\n  // @ts-expect-error - not worth further time investment IMO, maybe it'll work some day\n  (item, cur) => ({\n    ...item,\n    [cur.id]: true\n  }), {});\n}\nconst SortableList = props => {\n  const themeProps = useThemeProps(props, 'SortableList');\n  const {\n    data,\n    onOrderChange,\n    enableHaptic,\n    scale,\n    itemProps,\n    horizontal,\n    ...others\n  } = themeProps;\n  const itemsOrder = useSharedValue(generateItemsOrder(data));\n  const lockedIds = useSharedValue(generateLockedIds(data));\n  const itemSize = useSharedValue(DEFAULT_LIST_ITEM_SIZE);\n  useDidUpdate(() => {\n    itemsOrder.value = generateItemsOrder(data);\n  }, [data]);\n  const onChange = useCallback(() => {\n    const newData = [];\n    const dataByIds = _mapKeys(data, 'id');\n    if (data?.length) {\n      itemsOrder.value.forEach(itemId => {\n        newData.push(dataByIds[itemId]);\n      });\n    }\n    onOrderChange?.(newData);\n  }, [onOrderChange, data]);\n  const onItemLayout = useCallback(event => {\n    const {\n      height,\n      width\n    } = event.nativeEvent.layout;\n    // Round for Android\n    const newSize = Math.round(horizontal ? width : height);\n    // Check validity for tests\n    if (newSize) {\n      const margins = horizontal ? (itemProps?.margins?.marginLeft ?? 0) + (itemProps?.margins?.marginRight ?? 0) : (itemProps?.margins?.marginTop ?? 0) + (itemProps?.margins?.marginBottom ?? 0);\n      itemSize.value = newSize + margins;\n    }\n  }, []);\n  const context = useMemo(() => {\n    return {\n      data,\n      itemsOrder,\n      lockedIds,\n      onChange,\n      itemSize,\n      horizontal,\n      itemProps,\n      onItemLayout,\n      enableHaptic,\n      scale\n    };\n  }, [data]);\n  return <GestureHandlerRootView>\n      <SortableListContext.Provider value={context}>\n        <FlatList {...others} horizontal={horizontal} data={data} CellRendererComponent={SortableListItem} removeClippedSubviews={false} // Workaround for crashing on Android (ArrayIndexOutOfBoundsException in ViewGroupDrawingOrderHelper.getChildDrawingOrder)\n      />\n      </SortableListContext.Provider>\n    </GestureHandlerRootView>;\n};\nexport default SortableList;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}