{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"validate\", \"validationMessage\", \"validateOnBlur\", \"validateOnChange\", \"validateOnStart\", \"onValidationFailed\", \"onChangeValidity\"];\nimport _isEmpty from \"lodash/isEmpty\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport { useCallback, useState, useEffect, useMemo } from 'react';\nimport * as Presenter from \"./Presenter\";\nimport { useDidUpdate } from \"../../hooks\";\nimport { Constants } from \"../../commons/new\";\nexport default function useFieldState(_ref) {\n  var _props$value;\n  var validate = _ref.validate,\n    validationMessage = _ref.validationMessage,\n    validateOnBlur = _ref.validateOnBlur,\n    validateOnChange = _ref.validateOnChange,\n    validateOnStart = _ref.validateOnStart,\n    onValidationFailed = _ref.onValidationFailed,\n    onChangeValidity = _ref.onChangeValidity,\n    props = _objectWithoutProperties(_ref, _excluded);\n  var propsValue = (_props$value = props.value) != null ? _props$value : props.defaultValue;\n  var _useState = useState(propsValue),\n    _useState2 = _slicedToArray(_useState, 2),\n    value = _useState2[0],\n    setValue = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isFocused = _useState4[0],\n    setIsFocused = _useState4[1];\n  var _useState5 = useState(undefined),\n    _useState6 = _slicedToArray(_useState5, 2),\n    isValid = _useState6[0],\n    setIsValid = _useState6[1];\n  var _useState7 = useState(undefined),\n    _useState8 = _slicedToArray(_useState7, 2),\n    failingValidatorIndex = _useState8[0],\n    setFailingValidatorIndex = _useState8[1];\n  var isMandatory = useMemo(function () {\n    return typeof validate === 'string' && validate === 'required' || Array.isArray(validate) && validate.includes('required');\n  }, [validate]);\n  useEffect(function () {\n    if (Constants.isWeb && !props.value && props.defaultValue && props.defaultValue !== value) {\n      setValue(props.defaultValue);\n      if (validateOnStart) {\n        validateField(props.defaultValue);\n      }\n    }\n  }, [props.defaultValue, validateOnStart]);\n  useEffect(function () {\n    if (validateOnStart) {\n      validateField();\n    }\n  }, []);\n  useEffect(function () {\n    if (propsValue !== value) {\n      setValue(propsValue);\n      if (validateOnChange) {\n        validateField(propsValue);\n      }\n    }\n  }, [propsValue, validateOnChange]);\n  useDidUpdate(function () {\n    if (!_isUndefined(isValid)) {\n      onChangeValidity == null ? void 0 : onChangeValidity(isValid);\n    }\n  }, [isValid]);\n  var checkValidity = useCallback(function () {\n    var valueToValidate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : value;\n    var _Presenter$validate = Presenter.validate(valueToValidate, validate),\n      _Presenter$validate2 = _slicedToArray(_Presenter$validate, 1),\n      _isValid = _Presenter$validate2[0];\n    return _isValid;\n  }, [value, validate]);\n  var validateField = useCallback(function () {\n    var valueToValidate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : value;\n    var _Presenter$validate3 = Presenter.validate(valueToValidate, validate),\n      _Presenter$validate4 = _slicedToArray(_Presenter$validate3, 2),\n      _isValid = _Presenter$validate4[0],\n      _failingValidatorIndex = _Presenter$validate4[1];\n    setIsValid(_isValid);\n    setFailingValidatorIndex(_failingValidatorIndex);\n    if (!_isValid && !_isUndefined(_failingValidatorIndex)) {\n      onValidationFailed == null ? void 0 : onValidationFailed(_failingValidatorIndex);\n    }\n    return _isValid;\n  }, [value, validate, onValidationFailed]);\n  var onFocus = useCallback(function () {\n    setIsFocused(true);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    props.onFocus == null ? void 0 : props.onFocus.apply(props, args);\n  }, [props.onFocus]);\n  var onBlur = useCallback(function () {\n    setIsFocused(false);\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    props.onBlur == null ? void 0 : props.onBlur.apply(props, args);\n    if (validateOnBlur) {\n      validateField();\n    }\n  }, [props.onBlur, validateOnBlur, validateField]);\n  var onChangeText = useCallback(function (text) {\n    setValue(text);\n    props.onChangeText == null ? void 0 : props.onChangeText(text);\n    if (validateOnChange) {\n      validateField(text);\n    }\n  }, [props.onChangeText, validateOnChange, validateField]);\n  var fieldState = useMemo(function () {\n    return {\n      value: value,\n      hasValue: !_isEmpty(value),\n      isValid: validationMessage && !validate ? false : isValid != null ? isValid : true,\n      isFocused: isFocused,\n      failingValidatorIndex: failingValidatorIndex,\n      isMandatory: isMandatory\n    };\n  }, [value, isFocused, isValid, failingValidatorIndex, validationMessage, validate, isMandatory]);\n  return {\n    onFocus: onFocus,\n    onBlur: onBlur,\n    onChangeText: onChangeText,\n    fieldState: fieldState,\n    validateField: validateField,\n    checkValidity: checkValidity\n  };\n}","map":{"version":3,"names":["_isEmpty","_isUndefined","useCallback","useState","useEffect","useMemo","Presenter","useDidUpdate","Constants","useFieldState","_ref","_props$value","validate","validationMessage","validateOnBlur","validateOnChange","validateOnStart","onValidationFailed","onChangeValidity","props","_objectWithoutProperties","_excluded","propsValue","value","defaultValue","_useState","_useState2","_slicedToArray","setValue","_useState3","_useState4","isFocused","setIsFocused","_useState5","undefined","_useState6","isValid","setIsValid","_useState7","_useState8","failingValidatorIndex","setFailingValidatorIndex","isMandatory","Array","isArray","includes","isWeb","validateField","checkValidity","valueToValidate","arguments","length","_Presenter$validate","_Presenter$validate2","_isValid","_Presenter$validate3","_Presenter$validate4","_failingValidatorIndex","onFocus","_len","args","_key","apply","onBlur","_len2","_key2","onChangeText","text","fieldState","hasValue"],"sources":["/Users/mac/Repositories/BlockmakerIT/02-building-manager-mvp-app/node_modules/react-native-ui-lib/src/components/textField/useFieldState.js"],"sourcesContent":["import _isEmpty from \"lodash/isEmpty\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport { useCallback, useState, useEffect, useMemo } from 'react';\nimport * as Presenter from \"./Presenter\";\nimport { useDidUpdate } from \"../../hooks\";\nimport { Constants } from \"../../commons/new\";\nexport default function useFieldState({\n  validate,\n  validationMessage,\n  validateOnBlur,\n  validateOnChange,\n  validateOnStart,\n  onValidationFailed,\n  onChangeValidity,\n  ...props\n}) {\n  const propsValue = props.value ?? props.defaultValue;\n  const [value, setValue] = useState(propsValue);\n  const [isFocused, setIsFocused] = useState(false);\n  const [isValid, setIsValid] = useState(undefined);\n  const [failingValidatorIndex, setFailingValidatorIndex] = useState(undefined);\n  const isMandatory = useMemo(() => typeof validate === 'string' && validate === 'required' || Array.isArray(validate) && validate.includes('required'), [validate]);\n  useEffect(() => {\n    if (Constants.isWeb && !props.value && props.defaultValue && props.defaultValue !== value) {\n      setValue(props.defaultValue);\n      if (validateOnStart) {\n        validateField(props.defaultValue);\n      }\n    }\n\n    /* On purpose listen only to props.defaultValue change */\n    /* eslint-disable-next-line react-hooks/exhaustive-deps*/\n  }, [props.defaultValue, validateOnStart]);\n  useEffect(() => {\n    if (validateOnStart) {\n      validateField();\n    }\n  }, []);\n  useEffect(() => {\n    if (propsValue !== value) {\n      setValue(propsValue);\n      if (validateOnChange) {\n        validateField(propsValue);\n      }\n    }\n    /* On purpose listen only to propsValue change */\n    /* eslint-disable-next-line react-hooks/exhaustive-deps*/\n  }, [propsValue, validateOnChange]);\n  useDidUpdate(() => {\n    if (!_isUndefined(isValid)) {\n      onChangeValidity?.(isValid);\n    }\n  }, [isValid]);\n  const checkValidity = useCallback((valueToValidate = value) => {\n    const [_isValid] = Presenter.validate(valueToValidate, validate);\n    return _isValid;\n  }, [value, validate]);\n  const validateField = useCallback((valueToValidate = value) => {\n    const [_isValid, _failingValidatorIndex] = Presenter.validate(valueToValidate, validate);\n    setIsValid(_isValid);\n    setFailingValidatorIndex(_failingValidatorIndex);\n    if (!_isValid && !_isUndefined(_failingValidatorIndex)) {\n      onValidationFailed?.(_failingValidatorIndex);\n    }\n    return _isValid;\n  }, [value, validate, onValidationFailed]);\n  const onFocus = useCallback((...args) => {\n    setIsFocused(true);\n    //@ts-expect-error\n    props.onFocus?.(...args);\n  }, [props.onFocus]);\n  const onBlur = useCallback((...args) => {\n    setIsFocused(false);\n    //@ts-expect-error\n    props.onBlur?.(...args);\n    if (validateOnBlur) {\n      validateField();\n    }\n  }, [props.onBlur, validateOnBlur, validateField]);\n  const onChangeText = useCallback(text => {\n    setValue(text);\n    props.onChangeText?.(text);\n    if (validateOnChange) {\n      validateField(text);\n    }\n  }, [props.onChangeText, validateOnChange, validateField]);\n  const fieldState = useMemo(() => {\n    return {\n      value,\n      hasValue: !_isEmpty(value),\n      isValid: validationMessage && !validate ? false : isValid ?? true,\n      isFocused,\n      failingValidatorIndex,\n      isMandatory\n    };\n  }, [value, isFocused, isValid, failingValidatorIndex, validationMessage, validate, isMandatory]);\n  return {\n    onFocus,\n    onBlur,\n    onChangeText,\n    fieldState,\n    validateField,\n    checkValidity\n  };\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}